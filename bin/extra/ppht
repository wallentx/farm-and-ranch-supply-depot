#!/usr/bin/env bash

HOURS=${1:-24}

echo "Calculating Proofs Per Hour for the past $HOURS hours..."

findProofs() {
  {
    printf '%s\t%s\n' "Hour" "Proofs Found"
    for H in $(seq 1 $HOURS | xargs -I {} date -d '{} hour ago' "+%FT%H"); do
      PROOFS=$(echo "$(rg 'Found [1-9] proofs' <(rg $H ~/.chia/mainnet/log/*.log*) | wc -l)")
      paste <(echo $H) <(printf "%6s\n" "$PROOFS")
    done | tac
  }
}

findProofs | ptable 2 blue
