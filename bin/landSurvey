#!/usr/bin/env bash

## Description: Surveys a given path (i.e. /dev/sdX, or /mnt/foo) and determines how many -k32 plots will fit within that location based on its curremt available space.

TARGET=unset

usage() {
  printf '\nUsage: surveyLand </target/path>'
    exit 2
}

while getopts "h" arg; do
  case arg in
    -h | --help)   usage
		   ;;
    *)             [[ -d "$1" ]] || usage
		   ;;
  esac
done

TARGET=$1
PLOTSIZE=106400000
AVAIL=$(df --output=avail --sync $TARGET | tail -n 1)
PLOTCOUNT=$(($AVAIL / $PLOTSIZE))

if [[ $PLOTCOUNT -gt 1 ]]; then
        echo "At its current availability, you can fit $PLOTCOUNT final plots on $TARGET."
elif [[ $PLOTCOUNT -gt 0 ]]; then
        echo "At its current availability, you can fit $PLOTCOUNT final plot on $TARGET."
else
        echo "You can't fit any plots on $TARGET"
fi
